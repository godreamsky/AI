# STM32F407VGT6 + ST7796(i8080 16位) + FT6336U（FSMC 直连版）

这版代码按你前面确认的接线方式编写：**F407 的 FSMC 标准引脚 + NE1/A16 映射**。
并且去掉了 `stm32f4xx_hal_sram.h` / `HAL_SRAM_Init` 依赖，直接寄存器初始化 FSMC。

## 1) 接线表（按代码默认）

### LCD 数据线（16 位）

- D0  -> PD14
- D1  -> PD15
- D2  -> PD0
- D3  -> PD1
- D4  -> PE7
- D5  -> PE8
- D6  -> PE9
- D7  -> PE10
- D8  -> PE11
- D9  -> PE12
- D10 -> PE13
- D11 -> PE14
- D12 -> PE15
- D13 -> PD8
- D14 -> PD9
- D15 -> PD10

### LCD 控制线

- RD   -> PD4  (NOE)
- WR   -> PD5  (NWE)
- CS   -> PD7  (NE1)
- RS/DC-> PD11 (A16)
- RST  -> PA5
- BL   -> PB13（默认高电平点亮）

### FT6336U 触摸

- SDA -> PB11
- SCL -> PB10
- 地址 -> `0x38`

## 2) 地址映射

- 命令寄存器：`0x60000000`
- 数据寄存器：`0x60020000`

> 前提：CS=NE1、RS=FSMC_A16。

## 3) 触摸方向

在代码里改 `TOUCH_MAP_MODE`：

- `0`：直通（默认）
- `1`：顺时针 90°
- `2`：180°
- `3`：逆时针 90°

## 4) 游戏布局

- 屏幕：`320x480`
- 顶部积分栏：`320x40`（占一排格子高度）
- 棋盘：`8x11`
- 单元格：`40x40`

## 5) 上电现象

- 先显示彩条（用于确认 FSMC 显示链路正常）
- 然后进入消消乐画面（左上角有分数 HUD）

## 6) 如果仍“背光亮但无图像”

优先检查：

1. RS 是否接到 A16（PD11），CS 是否接到 NE1（PD7）
2. D0..D15 是否一一对应接对
3. 屏模块是否确认为 ST7796 且工作在 8080 16-bit
4. 背光极性是否与你模组相反
